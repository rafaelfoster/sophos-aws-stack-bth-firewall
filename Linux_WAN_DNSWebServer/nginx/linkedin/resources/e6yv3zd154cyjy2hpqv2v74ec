define.alias("artdeco-button/components/artdeco-button","participate-text-editor/components/artdeco-button")
define.alias("artdeco-modal/components/artdeco-confirmation-dialog","participate-text-editor/components/artdeco-confirmation-dialog")
define.alias("artdeco-dropdown/components/artdeco-dropdown-content","participate-text-editor/components/artdeco-dropdown-content")
define.alias("artdeco-dropdown/components/artdeco-dropdown-header","participate-text-editor/components/artdeco-dropdown-header")
define.alias("artdeco-dropdown/components/artdeco-dropdown-item","participate-text-editor/components/artdeco-dropdown-item")
define.alias("artdeco-dropdown/components/artdeco-dropdown-trigger","participate-text-editor/components/artdeco-dropdown-trigger")
define.alias("artdeco-dropdown/components/artdeco-dropdown","participate-text-editor/components/artdeco-dropdown")
define.alias("artdeco-modal/components/container","participate-text-editor/components/artdeco-modal-container")
define.alias("artdeco-modal/components/artdeco-modal-content","participate-text-editor/components/artdeco-modal-content")
define.alias("artdeco-modal/components/artdeco-modal-footer","participate-text-editor/components/artdeco-modal-footer")
define.alias("artdeco-modal/components/artdeco-modal-header","participate-text-editor/components/artdeco-modal-header")
define.alias("artdeco-modal/components/artdeco-modal","participate-text-editor/components/artdeco-modal")
define.alias("ember-vector-images/components/custom-image","participate-text-editor/components/custom-image")
define.alias("ember-wormhole/components/ember-wormhole","participate-text-editor/components/ember-wormhole")
define.alias("ember-vector-images/components/lazy-background","participate-text-editor/components/lazy-background")
define.alias("ember-vector-images/components/lazy-image","participate-text-editor/components/lazy-image")
define.alias("artdeco-icons-web/components/linkedin-logo","participate-text-editor/components/linkedin-logo")
define("participate-text-editor/components/text-editor-container",["exports","participate-text-editor/templates/components/text-editor-container"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
var i=Ember.Component.extend({layout:t.default,tagName:""})
e.default=i})
define("participate-text-editor/components/text-editor",["exports","participate-text-editor/templates/components/text-editor","ember-diff-attrs","global-utils/utils/keyboard-utils","participate-text-editor/utils/constants","participate-text-editor/utils/text-editor-utils","participate-text-editor/utils/editor-setup","global-utils/utils/is-browser","participate-text-editor/utils/quill/utils","participate-text-editor/utils/quill/delta-model-transformers","global-utils/utils/url","ember-lifeline","participate-text-editor/utils/tracking/texteditor-tracking","ember-cli-pemberly-tracking/utils/tracking","participate-text-editor/utils/tracking/mentions-tracking","participate-text-editor/utils/tracking/hashtag-tracking"],function(e,t,i,n,r,a,s,o,l,d,c,u,h,p,m,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
var f=Ember.Component.extend({layout:t.default,classNames:["editor-container"],a11yNotification:Ember.inject.service("global-services@a11y-notification"),authenticatedUser:Ember.inject.service("authentication@authenticated-user"),tracking:Ember.inject.service("tracking"),editor:null,highlightedElContainer:null,shouldFocusOnRender:!1,shareMediaUrns:Ember.computed("shareMediaUrn",(function(){return this.shareMediaUrn?[this.shareMediaUrn]:[]})),didReceiveAttrs:(0,i.default)("ariaActiveId","disabled",(function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n]
this._super.apply(this,i)
if(e){"ariaActiveId"in e&&this._setActiveDescendent(this.ariaActiveId)
"disabled"in e&&this.editor.enable(!this.disabled)}})),didInsertElement(){if(o.default){const e=(0,s.setupQuillEditor)(this.element,()=>!this.isDestroying&&this.dropDownIsActive,this.placeholder,e=>(0,u.debounceTask)(this,"_handleReportedTextChanges",e,300),this._openTypeahead.bind(this),this._dismissTypeaheadType.bind(this),this._generateNewWorkflowId.bind(this),this._fireCustomTexteditorTrackingEvent.bind(this),this._fireControlInteractionEvent.bind(this),this.tracking.generateControlUrn(this.associatedInputControlUrn),this.associatedEntityUrn,this.controlType,this.rootObject,this.updateMetadata,this.shouldFocusOnRender)
Ember.set(this,"editor",e)
Ember.set(this,"editorElement",this.element.querySelector(r.QUILL_EDITOR_SELECTOR))
this.initialContent&&this._appendTextAndMentions(this.initialContent,this.cursorRange)
this.disabled&&this.editor.disable()
Ember.tryInvoke(this,"setInsertContentHandler",[this._insertContent.bind(this)])
Ember.tryInvoke(this,"setResetEditorHandler",[this._resetEditor.bind(this)])}},recommendedMentionExistsInResultsList:Ember.computed("typeaheadResults","recommendedMention",(function(){const{recommendedMention:e}=this
return e?this.typeaheadResults.filter(t=>Ember.get(t,"objectUrn")===Ember.get(e,"objectUrn"))[0]:null})),filteredResults:Ember.computed("typeaheadResults","shouldShowRecommendedMention","recommendedMention","recommendedMentionExistsInResultsList",(function(){const{recommendedMentionExistsInResultsList:e}=this,t=this.typeaheadResults.filter(e=>!["ESCAPE_HATCH","AUTO_COMPLETE"].includes(Ember.get(e,"type")))
if(e){t.removeObject(e)
t.unshiftObject(e)
return t}if(this.shouldShowRecommendedMention){t.unshiftObject(this.recommendedMention)
return t}return t})),shouldShowRecommendedMention:Ember.computed("recommendedMention","showRecommendedMentionActor",(function(){return this.recommendedMention&&this.showRecommendedMentionActor})),isTypeaheadAbleToExpand:Ember.computed("hashtagShouldOpen","mentionShouldOpen",(function(){return this.hashtagShouldOpen||this.mentionShouldOpen})).readOnly(),texteditorTracker:Ember.computed("workflowId","tracking",(function(){return new h.default(this.tracking,this.workflowId)})),dropDownIsActive:Ember.computed("activeDescendantId","isTypeaheadAbleToExpand",(function(){return this.isTypeaheadAbleToExpand&&Ember.isPresent(this.activeDescendantId)})).readOnly(),_dismissTypeaheadWithoutSelection(){this.isDestroying||Ember.tryInvoke(this,"onDismissWithoutSelection",[this.typeaheadQuery])},_generateNewWorkflowId(){Ember.set(this,"workflowId",(0,p.generateTrackingId)())},_setActiveDescendent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null
Ember.set(this,"activeDescendantId",e)
e?Ember.getWithDefault(this,"editorElement",this.element.querySelector(r.QUILL_EDITOR_SELECTOR)).setAttribute("aria-activedescendant",e):Ember.getWithDefault(this,"editorElement",this.element.querySelector(r.QUILL_EDITOR_SELECTOR)).removeAttribute("aria-activedescendant")},_insertContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]
t?this._insertTextAtCursor(e.text):this._appendTextAndMentions(e)},_resetEditor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]
const{editor:t}=this
t.setContents([])
e&&t.history.clear()},_insertTextAtCursor(e){if(!e)return
const{editor:t}=this,{index:i=0}=t.getSelection(!0),n=t.getText()
let r=e
i>0&&!/\s/.test(n[i-1])&&(r=` ${r}`);["#","ï¼ƒ"].includes(e)||/\s/.test(r[r.length-1])||(r=`${r} `)
t.insertText(i,r,"user")
t.setSelection(i+r.length,0)},_appendTextAndMentions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const{editor:i}=this,{text:n,mentions:r}=e
if(n||r){const n=(0,d.deltaFromTextMentionsObject)(e),r=i.getContents(0,i.getLength()-1)
i.setContents(r.concat(n))
const{startCursor:a=i.getLength(),endCursor:s=0}=t
i.setSelection(a,s)}},_handleReportedTextChanges(e){if(!e)return
const{mentions:t,text:i}=(0,d.deltaToTextMentionsObject)(e),n=e.ops.rejectBy("attributes").reduce((e,t)=>e.concat((0,c.getUrlsFromText)(t.insert)),[])
n.length&&Ember.tryInvoke(this,"onFoundUrl",[n[0]])
Ember.tryInvoke(this,"updateCharCount",[i.length])
Ember.tryInvoke(this,"textChangeHandler",[t,i])},_handleArrowKey(e,t){e.preventDefault()
Ember.tryInvoke(this,"arrowKeyPressed",[t])},_addRecommendedMentionToResultsList(e){const t=Ember.get(this,"recommendedMention.text.text"),i=t&&(0,a.mentionQueryMatchesRecommendedMention)(t,e)
Ember.set(this,"showRecommendedMentionActor",i)},_openTypeahead(e){let{typeaheadQuery:t,onTypeaheadSelect:i,typeaheadType:n,onDismissWithoutSelection:r}=e
if(o.default&&!this.element.contains(document.activeElement))return
const{editor:a}=this
Ember.set(this,"typeaheadType",n)
if(a){Ember.setProperties(this,{typeaheadQuery:t,onTypeaheadSelect:i,onDismissWithoutSelection:r,[`${n}ShouldOpen`]:!0,commentary:a.getText(),typeaheadTopPosition:this._calculateTypeaheadTopOffset()})
this._addRecommendedMentionToResultsList(t)}},focusOut(e){let{relatedTarget:t}=e
if(!this.element.contains(t)){this._dismissTypeaheadWithoutSelection()
this._closeTypeahead()}},focusIn(){Ember.tryInvoke(this,"onEditorFocus")},_fireControlInteractionEvent(e){this.tracking.fireInteractionEvent(e)},_fireCustomTexteditorTrackingEvent(e,t,i){this.texteditorTracker.fireTrackingEvent(e,t,i)},_dismissTypeaheadType(e){if(!this.isDestroying){if(this.typeaheadPopulatedwithType===e){this._dismissTypeaheadWithoutSelection()
Ember.set(this,"typeaheadPopulatedwithType",null)}Ember.setProperties(this,{[`${e}ShouldOpen`]:!1})
this.isTypeaheadAbleToExpand||this._closeTypeahead()}},_closeTypeahead(){if(!this.isDestroying){Ember.setProperties(this,{mentionShouldOpen:!1,hashtagShouldOpen:!1,typeaheadPopulatedwithType:null,typeaheadQuery:null})
this._setActiveDescendent()
Ember.getWithDefault(this,"editorElement",this.element.querySelector(r.QUILL_EDITOR_SELECTOR)).removeAttribute("aria-owns")}},_calculateTypeaheadTopOffset(){const{editor:e}=this,{index:t=0}=e.getSelection()||{},{top:i,height:n}=e.getBounds(t)
return this.element.offsetTop+i+n*Ember.getWithDefault(this,"lineHeightOffSet",1.2)},keyUp(e){if(this.typeaheadPopulatedwithType&&(0,n.isEscapeKey)(e)){e.stopPropagation()
this._dismissTypeaheadWithoutSelection()
this._closeTypeahead()}},keyDown(e){if(!e.isComposing)if(this.typeaheadPopulatedwithType){if((0,n.isDownArrowKey)(e))this._handleArrowKey(e,r.KEY_DOWN)
else if((0,n.isUpArrowKey)(e))this._handleArrowKey(e,r.KEY_UP)
else if((0,n.isTabKey)(e)){this._dismissTypeaheadWithoutSelection()
this._closeTypeahead()}else if((0,n.isEnterKey)(e))if(this.dropDownIsActive){e.preventDefault()
Ember.tryInvoke(this,"enterKeyPressed")}else{this._dismissTypeaheadWithoutSelection()
this._closeTypeahead()}}else if((0,n.isEnterKey)(e)&&this.submitOnEnterKey){const{text:e,mentions:t}=(0,d.deltaToTextMentionsObject)(this.editor.getContents())
Ember.tryInvoke(this,"onSubmitComment",[e,t])}},_getFormattedMentionsResults(e){const t=[]
e.forEach((e,i)=>{const n={entityUrn:Ember.get(e,"objectUrn"),position:{index:i},isCacheHit:!1}
t.push(n)})
return t},_getFormattedHashtagResults(e){const t=[]
e.forEach((e,i)=>{const n={entityUrn:Ember.get(e,"objectUrn"),position:{index:i},trackingId:Ember.get(e,"trackingId")}
t.push(n)})
return t},_trackTypeaheadRenderedImpressionsSetup(e){switch(this.typeaheadType){case r.TYPEAHEAD_TYPES_MAP.MENTION:{const t={searchHeader:(0,m.getSearchHeaderForMentionsTrackingEvent)(this.typeaheadQuery),results:this._getFormattedMentionsResults(e)}
this._fireCustomTexteditorTrackingEvent("MentionSuggestionImpressionEvent",t,r.TYPEAHEAD_TYPES_MAP.MENTION)
break}case r.TYPEAHEAD_TYPES_MAP.HASHTAG:{const t={searchHeader:(0,g.getSearchHeaderForHashtagTrackingEvent)(this.typeaheadQuery),results:this._getFormattedHashtagResults(e),hashtagSourceType:"TYPEAHEAD"}
this._fireCustomTexteditorTrackingEvent("HashtagSuggestionImpressionEvent",t,r.TYPEAHEAD_TYPES_MAP.HASHTAG)
break}}},actions:{transformTypeaheadResponse(e){if(e.length){Ember.set(this,"typeaheadResults",e)
return this.filteredResults}return e},typeaheadSelect(e,t){this._closeTypeahead()
const i=this.typeheadResultsList.indexOf(t),n=(0,l.normalizeTypeaheadResponse)(t)
Ember.tryInvoke(this,"onTypeaheadSelect",[n,i])},onTypeaheadResultsRendered(e){if(this.element&&!Ember.isEmpty(e)){const t=this.element.querySelector(".editor-typeahead-fetch")
t&&(t.style.top=`${this.typeaheadTopPosition}px`)
this._setActiveDescendent()
Ember.setProperties(this,{typeaheadPopulatedwithType:this.typeaheadType,typeheadResultsList:e})
Ember.getWithDefault(this,"editorElement",this.element.querySelector(r.QUILL_EDITOR_SELECTOR)).setAttribute("aria-owns",this.triggeredContentId)
this._trackTypeaheadRenderedImpressionsSetup(e)}},onEditorDragover(e){e.preventDefault()
return!1}}})
e.default=f})
define("participate-text-editor/components/typeahead-fetch",["exports","participate-text-editor/templates/components/typeahead-fetch"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
var i=Ember.Component.extend({layout:t.default,classNames:["editor-typeahead-fetch"],"data-test-editor-typeahead-fetch":!0})
e.default=i})
define("participate-text-editor/config/environment",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
let t
try{const e="participate-text-editor/config/environment",i=document.querySelector('meta[name="'+e+'"]').getAttribute("content")
t=JSON.parse(unescape(i))}catch(n){t={}}var i=t
e.default=i})
define.alias("ember-m3/adapters/interop-debug-adapter","participate-text-editor/data-adapter")
define.alias("ember-cli-pemberly-i18n/helpers/bidi-dir","participate-text-editor/helpers/bidi-dir")
define.alias("ember-cli-pemberly-i18n/helpers/format-currency","participate-text-editor/helpers/format-currency")
define.alias("ember-cli-pemberly-i18n/helpers/format-date","participate-text-editor/helpers/format-date")
define.alias("ember-cli-pemberly-i18n/helpers/format-name","participate-text-editor/helpers/format-name")
define.alias("ember-cli-pemberly-i18n/helpers/format-number","participate-text-editor/helpers/format-number")
define.alias("ember-cli-pemberly-i18n/helpers/format-time","participate-text-editor/helpers/format-time")
define.alias("ember-cli-pemberly-i18n/helpers/format-truncate","participate-text-editor/helpers/format-truncate")
define.alias("ember-cli-pemberly-i18n/helpers/is-any-locale","participate-text-editor/helpers/is-any-locale")
define.alias("ember-cli-pemberly-i18n/helpers/is-cjk-language","participate-text-editor/helpers/is-cjk-language")
define.alias("ember-cli-pemberly-i18n/helpers/is-rtl-content","participate-text-editor/helpers/is-rtl-content")
define.alias("ember-cli-pemberly-i18n/helpers/is-rtl-language","participate-text-editor/helpers/is-rtl-language")
define.alias("artdeco-icons-web/helpers/li-icon","participate-text-editor/helpers/li-icon")
define.alias("ember-app-scheduler/helpers/route-idle","participate-text-editor/helpers/route-idle")
define.alias("ember-cli-pemberly-i18n/helpers/t-link-to","participate-text-editor/helpers/t-link-to")
define.alias("ember-cli-pemberly-i18n/helpers/t-make-name","participate-text-editor/helpers/t-make-name")
define.alias("ember-cli-pemberly-i18n/helpers/t","participate-text-editor/helpers/t")
define("participate-text-editor/initializers/artdeco",["exports","artdeco-eyeglass"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.initialize=r
e.default=void 0
const i=[t.default.contextClasses,t.default.floatingLabel,t.default.focusOutline]
function n(e,t){const n=e[t]
e[t]=function(){i.forEach(e=>e&&"function"==typeof e.teardown&&e.teardown())
n&&"function"==typeof n&&n.call(e)}}function r(e){if("undefined"!=typeof document){i.forEach(e=>e.install())
"function"==typeof e.willDestroy?n(e,"willDestroy"):"function"==typeof e.destroy&&n(e,"destroy")}}var a={name:"artdeco",initialize:r}
e.default=a})
define.alias("ember-cli-pemberly-i18n/initializers/i18n","participate-text-editor/initializers/i18n")
define("participate-text-editor/initializers/icons",["exports","artdeco-icons-web/src/icons","participate-text-editor/config/environment"],function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
function n(e){throw e}var r={name:"icons",initialize:function(){const{environment:e,APP:r}=i.default
let a,s
r&&({artdecoCustomSpriteUrl:a,artdecoCustomSpriteName:s}=r)
const o="test"!==e
t.default.load(o,a,s).catch(n)}}
e.default=r})
define.alias("ember-m3/initializers/m3-store","participate-text-editor/initializers/m3-store")
define("participate-text-editor/initializers/override-safestring",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.initialize=r
e.default=void 0
const t="ember-glimmer",i="ember-htmlbars/utils/string",n="@ember/-internals/glimmer"
function r(){let e,r=Ember.__loader.require.has
if(r(n))e=Ember.__loader.require(n).SafeString
else if(r(t))e=Ember.__loader.require(t).SafeString
else{if(!r(i))throw new Error("Cannot locate SafeString class for overriding")
e=Ember.__loader.require(i).SafeString}e.prototype.toHTML=function(){return jSecure.sanitizeHTML(this.toString())}
e.prototype.toString=function(){return`${this.string}`}}var a={name:"override-safestring",initialize:r}
e.default=a})
define("participate-text-editor/instance-initializers/-t-link-to",["exports","ember-stdlib/utils/is-browser"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.initialize=i
e.default=void 0
function i(e){t.default&&e.lookup("service:-t-link-to")}var n={name:"-t-link-to",initialize:i}
e.default=n})
define.alias("ember-cli-pemberly-i18n/services/-t-link-to","participate-text-editor/services/-t-link-to")
define.alias("artdeco-modal/services/artdeco-modal","participate-text-editor/services/artdeco-modal")
define.alias("client-sensor-web/services/client-sensor","participate-text-editor/services/client-sensor")
define.alias("ember-cli-pemberly-i18n/services/formatter","participate-text-editor/services/formatter")
define.alias("ember-cli-pemberly-i18n/services/i18n","participate-text-editor/services/i18n")
define.alias("@linkedin/ember-pem/services/internal-event-utils","participate-text-editor/services/internal-event-utils")
define.alias("@linkedin/ember-pem/services/internal-pem-tracking","participate-text-editor/services/internal-pem-tracking")
define.alias("ember-cli-pemberly-i18n/services/locale","participate-text-editor/services/locale")
define.alias("ember-m3/services/m3-schema-manager","participate-text-editor/services/m3-schema-manager")
define.alias("@linkedin/ember-pem/services/pem-tracking","participate-text-editor/services/pem-tracking")
define.alias("ember-cli-pemberly-m3/services/store","participate-text-editor/services/store")
define("participate-text-editor/templates/components/text-editor-container",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
var t=Ember.HTMLBars.template({id:"vxpya+BV",block:'{"symbols":["typeahead"],"statements":[[4,"basic-typeahead@basic-typeahead",null,[["alwaysExpanded"],[true]],{"statements":[[0,"  "],[1,[28,"participate-text-editor@text-editor",null,[["triggered-content","arrowKeyPressed","enterKeyPressed","triggeredContentId","ariaActiveId","placeholder","controlName","jumpLinkTarget","groupIdForMentionsTypeahead","textChangeHandler","onFoundUrl","updateCharCount","editorWrapperOffsetFromTop","initialContent","cursorRange","setInsertContentHandler","setResetEditorHandler","associatedInputControlUrn","controlType","associatedEntityUrn","rootObject","updateMetadata","recommendedMention","lineHeightOffSet","shouldFocusOnRender","disabled","onEditorFocus","submitOnEnterKey","onSubmitComment"],[[23,1,["triggered-content"]],[23,1,["arrowKeyPressed"]],[23,1,["enterKeyPressed"]],[23,1,["triggeredContentId"]],[23,1,["ariaActiveId"]],[23,0,["placeholder"]],[23,0,["controlName"]],[23,0,["jumpLinkTarget"]],[23,0,["groupIdForMentionsTypeahead"]],[23,0,["textChangeHandler"]],[23,0,["onFoundUrl"]],[23,0,["updateCharCount"]],[23,0,["offsetFromTop"]],[23,0,["initialContent"]],[23,0,["cursorRange"]],[23,0,["setInsertContentHandler"]],[23,0,["setResetEditorHandler"]],[23,0,["associatedInputControlUrn"]],[23,0,["controlType"]],[23,0,["associatedEntityUrn"]],[23,0,["rootObject"]],[23,0,["updateMetadata"]],[23,0,["recommendedMention"]],[23,0,["lineHeightOffSet"]],[23,0,["shouldFocusOnRender"]],[23,0,["disabled"]],[23,0,["onEditorFocus"]],[23,0,["submitOnEnterKey"]],[23,0,["onSubmitComment"]]]]],false],[0,"\\n\\n"]],"parameters":[1]},null]],"hasEval":false}',meta:{moduleName:"participate-text-editor/templates/components/text-editor-container.hbs"}})
e.default=t})
define("participate-text-editor/templates/components/text-editor",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
var t=Ember.HTMLBars.template({id:"IoRbz6yT",block:'{"symbols":["queryFunction"],"statements":[[7,"div",true],[10,"class","editor-content"],[11,"data-control-name",[23,0,["controlName"]]],[11,"onfocus",[23,0,["focusIn"]]],[11,"ondragover",[28,"action",[[23,0,[]],"onEditorDragover"],null]],[11,"data-jump-link-target",[23,0,["jumpLinkTarget"]]],[8],[0,"\\n"],[9],[0,"\\n\\n"],[4,"if",[[23,0,["isTypeaheadAbleToExpand"]]],null,{"statements":[[4,"let",[[28,"if",[[23,0,["mentionShouldOpen"]],[28,"if",[[23,0,["groupIdForMentionsTypeahead"]],[28,"search-ta-kit@fetch-results",null,[["transform","queryContext","type","useCase"],[[28,"action",[[23,0,[]],"transformTypeaheadResponse"],null],[28,"hash",null,[["groupId"],[[23,0,["groupIdForMentionsTypeahead"]]]]],"GROUP_MEMBERS","MENTIONS"]]],[28,"search-ta-kit@fetch-results",null,[["transform","useCase"],[[28,"action",[[23,0,[]],"transformTypeaheadResponse"],null],"MENTIONS"]]]],null],[28,"search-ta-kit@fetch-hashtag-recommendations",null,[["commentary","urns"],[[23,0,["commentary"]],[23,0,["shareMediaUrns"]]]]]],null]],null,{"statements":[[0,"    "],[1,[28,"participate-text-editor@typeahead-fetch",null,[["fetchFn","typeaheadQuery","onTypeaheadResultsRendered","typeaheadSelect","triggered-content"],[[23,1,[]],[23,0,["typeaheadQuery"]],[28,"action",[[23,0,[]],"onTypeaheadResultsRendered"],null],[28,"action",[[23,0,[]],"typeaheadSelect"],null],[23,0,["triggered-content"]]]]],false],[0,"\\n"]],"parameters":[1]},null]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"participate-text-editor/templates/components/text-editor.hbs"}})
e.default=t})
define("participate-text-editor/templates/components/typeahead-fetch",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
var t=Ember.HTMLBars.template({id:"3smcSbyd",block:'{"symbols":["results","content","result"],"statements":[[4,"basic-typeahead@ta-fetch",null,[["keywords","onFetchResolve","fetchFn"],[[23,0,["typeaheadQuery"]],[23,0,["onTypeaheadResultsRendered"]],[23,0,["fetchFn"]]]],{"statements":[[4,"if",[[23,1,[]]],null,{"statements":[[4,"component",[[28,"ember-holy-futuristic-template-namespacing-batman@-translate-dynamic-2",[[23,0,["triggered-content"]]],null]],[["className"],["editor-typeahead__typeahead-tray"]],{"statements":[[4,"each",[[23,1,[]]],null,{"statements":[[4,"component",[[28,"-assert-implicit-component-helper-argument",[[23,2,["selectable"]],"expected `content.selectable` to be a contextual component but found a string. Did you mean `(component content.selectable)`? (\'participate-text-editor/templates/components/typeahead-fetch.hbs\' @ L11:C11) "],null]],[["class","keywordsValue","onSelect","value"],["editor-typeahead__typeahead-item",[23,3,["text","text"]],[23,0,["typeaheadSelect"]],[23,3,[]]]],{"statements":[[0,"          "],[1,[28,"search-ta-kit@typeahead-result",null,[["hit"],[[23,3,[]]]]],false],[0,"\\n"]],"parameters":[]},null]],"parameters":[3]},null]],"parameters":[2]},null]],"parameters":[]},null]],"parameters":[1]},null]],"hasEval":false}',meta:{moduleName:"participate-text-editor/templates/components/typeahead-fetch.hbs"}})
e.default=t})
define("participate-text-editor/utils/constants",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.TYPEAHEAD_TYPES_MAP=e.BLOT_WHITELIST=e.KEY_DOWN=e.KEY_RIGHT=e.KEY_UP=e.KEY_LEFT=e.QUILL_EDITOR_SELECTOR=e.QUILL_CONTAINER_SELECTOR=void 0
e.QUILL_CONTAINER_SELECTOR=".editor-content"
e.QUILL_EDITOR_SELECTOR=".ql-editor"
e.KEY_LEFT="Left"
e.KEY_UP="Up"
e.KEY_RIGHT="Right"
e.KEY_DOWN="Down"
const t=new Set(["hashtag","mention","guard"])
e.BLOT_WHITELIST=t
e.TYPEAHEAD_TYPES_MAP={MENTION:"mention",HASHTAG:"hashtag"}})
define.alias("client-sensor-web/utils/counter-buffer","participate-text-editor/utils/counter-buffer")
define("participate-text-editor/utils/editor-setup",["exports","@babel/runtime/helpers/esm/objectSpread2","participate-text-editor/utils/constants","participate-text-editor/utils/quill/modules/hashtag","participate-text-editor/utils/quill/modules/mention","participate-text-editor/utils/quill/modules/clipboard","quill","participate-text-editor/utils/quill/quill-keyboard-bindings"],function(e,t,i,n,r,a,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.setupQuillEditor=function(e,n,r,a,d,c,u,h,p,m,g,f,T,E,x){const b={"typeahead enter":{key:"enter",handler:()=>!n()}},y=(0,t.default)((0,t.default)({},o.enterKeyBinding),b),S=new s.default(e.querySelector(`${i.QUILL_CONTAINER_SELECTOR}`),{placeholder:r,formats:["hashtag","mention","guard","bold"],modules:{mention:{actions:{openTypeahead:d,closeTypeahead:c,generateNewWorkflowId:u,fireCustomTexteditorTrackingEvent:h,fireControlInteractionEvent:p},trackingData:{associatedInputControlUrn:m,associatedEntityUrn:g,controlType:f,rootObject:T,updateMetadata:E}},hashtag:{actions:{openTypeahead:d,closeTypeahead:c,generateNewWorkflowId:u,fireCustomTexteditorTrackingEvent:h,fireControlInteractionEvent:p},trackingData:{associatedInputControlUrn:m,controlType:f}},keyboard:{bindings:y},history:{delay:50,maxStack:300}}})
delete S.getModule("keyboard").bindings[l.keys.TAB]
const v=S.container.querySelector(i.QUILL_EDITOR_SELECTOR)
v.setAttribute("aria-placeholder",r)
v.setAttribute("aria-label",r)
v.setAttribute("role","textbox")
v.setAttribute("aria-multiline",!0)
v.setAttribute("data-test-ql-editor-contenteditable",!0)
a&&S.on("text-change",()=>{a(S.getContents())})
x&&S.focus()
return S}
s.default.register({"modules/mention":r.default,"modules/hashtag":n.default,"modules/clipboard":a.default})
const l=s.default.import("modules/keyboard")})
define.alias("client-sensor-web/utils/helpers","participate-text-editor/utils/helpers")
define("participate-text-editor/utils/quill/blots/hashtag",["exports","quill"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
const i=t.default.import("blots/inline")
class n extends i{}n.className="ql-hashtag"
n.tagName="strong"
n.blotName="hashtag"
var r=n
e.default=r})
define("participate-text-editor/utils/quill/blots/mention",["exports","@babel/runtime/helpers/esm/toConsumableArray","quill","participate-text-editor/utils/quill/mention-utils"],function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
const r=i.default.import("blots/inline"),a=i.default.import("blots/cursor"),s={characterData:!0,characterDataOldValue:!0,subtree:!0,childList:!0}
let o=0
class l extends r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
super(...arguments)
this.allowSegmentDeletion=!1
this.textSections=[]
this.originalText=""
t.entityUrn&&(this.entityUrn=t.entityUrn)
if(t.objectUrn){this.objectUrn=t.objectUrn
this.allowSegmentDeletion=(0,n.allowSegmentDeletion)(this.objectUrn)}if(t.originalText){this.textSections=l.getMentionTextSections(t.originalText)
this.originalText=t.originalText
this.cachedDomText=t.originalText}this.observer=new MutationObserver(e=>{this.update(e)})
this._enableMentionObserver()}static create(e){const t=super.create.apply(this,arguments)
t.setAttribute("href","#")
t.setAttribute("data-entity-urn",e.entityUrn)
t.setAttribute("data-guid",e.guid||l.createGuid())
t.setAttribute("data-object-urn",e.objectUrn)
t.setAttribute("data-original-text",e.originalText)
t.setAttribute("spellcheck","false")
return t}static formats(e){const t={}
t.entityUrn=e.getAttribute("data-entity-urn")||""
t.guid=e.getAttribute("data-guid")||""
t.objectUrn=e.getAttribute("data-object-urn")||""
t.originalText=e.getAttribute("data-original-text")||""
return t}static createGuid(){return o++}static getMentionTextSections(e){const t=/\s+/g,i=[]
let n=0,r=t.exec(e)
for(;r;){const[a]=r,s=e.slice(n,r.index)
s&&i.push({text:s,isSeparator:!1})
i.push({text:a,isSeparator:!0})
n=r.index+a.length
r=t.exec(e)}const a=e.slice(n,e.length)
a&&i.push({text:a,isSeparator:!1})
return i}static joinMentionTextSections(e){return e.map(e=>e.text).join("")}static getTextIndexOfSection(e,t){const i=e.indexOf(t)
if(-1===i)throw new Error(`Section not found in textSections - section: ${t}, textSections: ${e}`)
return e.slice(0,i).reduce((e,t)=>e+t.text.length,0)}optimize(){super.optimize.apply(this,arguments)
let{next:e,prev:t}=this
if((0,n.nextBlotIsEqualMention)(e,this)){this._disableMentionObserver()
for(;(0,n.nextBlotIsEqualMention)(e,this);){e.moveChildren(this)
e.remove()
e=e.next}this._enableMentionObserver()}else if((0,n.prevBlotIsEqualMention)(t,this)){this._disableMentionObserver()
for(;(0,n.nextBlotIsEqualMention)(e,this);){t.moveChildren(this)
t.remove()
t=t.prev}this._enableMentionObserver()}}update(e){super.update.apply(this,arguments)
e.forEach(e=>{if(!e.oldValue||!e.oldValue.includes(a.CONTENTS)){if("childList"===e.type&&e.target.className.includes(l.className)){if((0,t.default)(e.addedNodes).some(e=>e.classList&&e.classList.contains(a.className))){this.scroll.emitter.emit("mention-will-reload")
return}this.textSections=l.getMentionTextSections(this.domNode.innerText)}if("characterData"===e.type){const t=i.default.find(e.target)
if(!(t&&t.parent instanceof l))return
e.target.length<e.oldValue.length&&this.didRemoveMentionTextOnUpdate(e)
e.target.length>e.oldValue.length&&this.didAddMentionTextOnUpdate(e)
e.target.length===e.oldValue.length&&e.target.data!==e.oldValue&&this.didAddMentionTextOnUpdate(e)}}})}updateDomText(e){this._disableMentionObserver()
this.children.head.domNode.data=e
this._enableMentionObserver()
this.cachedDomText=e}deleteAt(e,t){if(0!==e||t!==this.length())if(this.cachedDomText.length<this.domNode.innerText.length)this.updateDomText(this.cachedDomText)
else{super.deleteAt.apply(this,arguments)
this.removeWordsInRange(e,e+t)}else{this.scroll.emitter.emit("mention-range-will-change",this,0)
super.deleteAt.apply(this,arguments)}}_disableMentionObserver(){this.observer.disconnect()}_enableMentionObserver(){this.observer.observe(this.domNode,s)}_shouldRemoveMentionSegment(){const e=l.joinMentionTextSections(this.textSections)
return this.domNode.innerText!==e}didAddMentionTextOnUpdate(e){const t=e.oldValue,i=e.target.textContent,r=i.length-t.length,a=(0,n.getIndexFirstDiff)(t,i),s=l.joinMentionTextSections(this.textSections)
if(0!==a)if(a+r!==this.length())this.scroll.emitter.emit("mention-will-unwrap",this)
else{const e=i.substring(a),n=t+e
if(n===s||n===this.originalText){this.textSections=l.getMentionTextSections(n)
return}this.scroll.emitter.emit("mention-move-text-after",this,e)
this.cachedDomText=this.domNode.innerText}else{const e=i.substring(a,r),n=e+t
if(n===s||n===this.originalText){this.textSections=l.getMentionTextSections(n)
return}this.scroll.emitter.emit("mention-move-text-before",this,e)
this.cachedDomText=this.domNode.innerText}}didRemoveMentionTextOnUpdate(e){if(this._shouldRemoveMentionSegment()){const t=e.oldValue,i=e.target.textContent,r=(0,n.getIndexFirstDiff)(t,i)
this.removeWordsInRange(r,r+1)}}static getSectionsToRevove(e,i,n){const r=new Set
e.forEach((t,a)=>{const s=l.getTextIndexOfSection(e,t),o=s+t.text.length
if(s<=i&&i<o){r.add(a)
t.isSeparator&&e[a-1]&&r.add(a-1)}if(s<n&&n<=o){r.add(a)
e[a-1]&&r.add(a-1)}i<s&&o<n&&r.add(a)})
return(0,t.default)(r).sort((e,t)=>e-t)}removeWordsInRange(e,t){if(this.textSections.length<=2||!this.allowSegmentDeletion){this.scroll.emitter.emit("mention-will-remove",this)
return}const i=l.getSectionsToRevove(this.textSections,e,t)
if(!i.length)return
const n=l.getTextIndexOfSection(this.textSections,this.textSections[i[0]])
this.textSections=this.textSections.filter((e,t)=>!i.includes(t))
if(this.textSections.length){this.textSections[0].isSeparator&&this.textSections.shift()
this.textSections[this.textSections.length-1].isSeparator&&this.textSections.pop()}this.updateDomText(l.joinMentionTextSections(this.textSections))
this.scroll.emitter.emit("mention-range-will-change",this,n)}}l.className="ql-mention"
l.tagName="a"
l.blotName="mention"
var d=l
e.default=d})
define("participate-text-editor/utils/quill/delta-model-transformers",["exports","rich-text/utils/constants","rich-text/utils/mentions-texteditor-helpers"],function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.deltaFromTextMentionsObject=function(e){const n={ops:[]},{text:r="",mentions:a=[]}=e,s=(function(e,n){const r=(0,t.getHashtagMatchRegex)()
let a=r.exec(e)
const s=[]
for(;a;){const t={}
t.match=(0,i.getHashtagAttributes)(a)
t.type="hashtag"
s.push(t)
a=r.exec(e)}return n.concat(s).sort((e,t)=>e.match.start-t.match.start)})(r,a)
s.length?s[0].match.start>0&&n.ops.push({insert:r.slice(0,s[0].match.start)}):n.ops.push({insert:r})
s.forEach((e,t)=>{const i=(function(e){if(Ember.get(e,"entity.entityUrn"))return{insert:e.match.text,attributes:{mention:{entityUrn:Ember.get(e,"entity.entityUrn"),objectUrn:Ember.get(e,"entity.objectUrn"),originalText:e.match.text,text:e.match.text}}}
if("hashtag"===e.type)return{insert:e.match.text,attributes:{hashtag:!0}}
return null})(e)
n.ops.push(i)
const a=e.match.start+e.match.length,o=s[t+1]
o?o.match.start>a&&n.ops.push({insert:r.slice(a,o.match.start)}):n.ops.push({insert:r.slice(a)})})
n.ops.push({insert:"\n"})
return n}
e.deltaToTextMentionsObject=function(e){let t=0
const i=e.ops.reduce((e,i)=>{const n=i.insert
e.text+=n
i.attributes&&i.attributes.mention&&e.mentions.push({match:{start:t,length:n.length,text:n},entity:{entityUrn:i.attributes.mention.entityUrn}})
t+=n.length
return e},{text:"",mentions:[]})
i.text.endsWith("\n")&&(i.text=i.text.slice(0,-1))
return i}})
define("participate-text-editor/utils/quill/formats/guard",["exports","quill"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
const i=t.default.import("blots/inline")
class n extends i{static create(){return super.create()}static formats(){return!0}}n.className="ql-guard"
n.blotName="guard"
n.CONTENT="â€‹"
var r=n
e.default=r})
define("participate-text-editor/utils/quill/hashtag-utils",["exports","@babel/runtime/helpers/esm/objectSpread2","quill","rich-text/utils/constants","participate-text-editor/utils/constants"],function(e,t,i,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.getValidHashtags=o
e.createDeltaWithPotentialHashtag=l
e.transformDelta=function(e){let i=new a
e.forEach((e,s)=>{const{operations:o,previousOperation:d}=(function(e,i,a){const s=(0,t.default)((0,t.default)({},e),{},{attributes:Object.keys(e.attributes||{}).reduce((t,i)=>{r.BLOT_WHITELIST.has(i)&&(t[i]=e.attributes[i])
return t},{})}),o=s.insert,d=i>0&&a[a.length-1]
if(s.attributes.hashtag)return (function(e,t,i){const r=l(e)
if(t&&t.attributes&&t.attributes.hashtag){const e=r[0].insert,a=(0,n.getHashtagMatchRegex)()
let s=e.match(a)
if(s&&s[0]===e)return{operations:[{insert:i.insert}]}
const o=t.insert+i.insert
if((s=o.match(a))&&s[0]===o){t.insert+=i.insert
return{previousOperation:t}}}else if(t&&!t.attributes&&t.insert[t.insert.length-1].match(/[/&\w]/)){t.insert+=i.insert
return{previousOperation:t}}return{operations:r}})(o,d,s)
if(s.attributes.mention||s.attributes.guard)return{operations:[s]}
return (function(e,t){const i=l(e)
if(t&&t.attributes&&t.attributes.hashtag){const[e]=i
if(e.attributes&&e.attributes.hashtag)i[0]={insert:e.insert}
else if(!e.attributes){const r=(0,n.getHashtagMatchRegex)()
let a=t.insert
const s=e.insert
let o=0
for(;o<s.length;o++){const e=a+s.slice(o,o+1),t=e.match(r)
if(!t||t[0]!==e)break
a=e}const l=s.slice(o)
l?i[0].insert=l:i.shift()
if(t.insert!==a){t.insert=a
return{operations:i,previousOperation:t}}return{operations:i}}}else if(t&&!t.attributes&&t.insert.length&&t.insert[t.insert.length-1].match(/[/&\w]/)){t.insert+=i[0].insert
i.shift()
return{previousOperation:t,operations:i}}return{operations:i}})(o,d)})(e,s,i.ops)
d&&(i.ops[i.ops.length-1]=d)
o&&o.length>0&&(i=i.concat(new a(o)))})
return i}
const a=i.default.import("delta")
function s(e){const[,t,i]=e
return{text:i,start:t?e.index+1:e.index,length:i.length}}function o(e){const t=(0,n.getHashtagMatchRegex)()
let i=t.exec(e)
const r=[]
for(;i;){r.push(s(i))
i=t.exec(e)}return r}function l(e){const t=o(e),i=[]
if(0===t.length)i.push({insert:e})
else{const n=t[t.length-1],r=n.start+n.length===e.length
let a=0
t.forEach(t=>{a<t.start&&i.push({insert:e.slice(a,t.start)})
i.push({insert:t.text,attributes:{hashtag:!0}})
a=t.start+t.length})
r||i.push({insert:e.slice(a)})}return i}})
define("participate-text-editor/utils/quill/mention-utils",["exports","global-utils/utils/urn-converter","participate-text-editor/utils/quill/utils","participate-text-editor/utils/quill/blots/mention"],function(e,t,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.allowSegmentDeletion=function(e){if(!e)return!1
const{type:i}=(0,t.fromUrn)(e,!1)
return r.includes(i)}
e.getIndexFirstDiff=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:""
if(null!==e&&null!==t&&e!==t){let i=0
for(;e[i]===t[i];)i++
return i}return-1}
e.isCharacterWhiteSpace=function(e,t){if(e){const i=new RegExp(/^\s$/)
return i.test(e.charAt(t))}return!1}
e.nextBlotIsEqualMention=function(e,t){return e instanceof n.default&&e.prev===t&&(0,i.isShallowEqualObjects)(t.formats().mention,e.formats().mention)}
e.getSearchQuery=function(e,t){const{before:n,current:r}=(function(e,t){const i=[]
let n=null,r=0
for(let a=0;a<e.ops.length;a++){const s=e.ops[a]
if(!((r+=s.insert.length)<t)){n=s
break}i.push(s)}return{before:i,current:n}})(e,t.index)
if(!r)return null
const l=(function(e,t){const i=e.insert.slice(0,t.index)
return o.reduce((e,t)=>{const n=i.lastIndexOf(t)
if(-1===n)return e
const r=n+t.length
return e&&e.indexAfterToken>r?e:{indexAfterToken:r,token:t}},null)})(r,t)
if(null===l)return null
const d=l.indexAfterToken-l.token.length
if(d>0&&(0,i.isAlphaNumericCharacter)(r.insert[d-1]))return null
const c=n.reduce((e,t)=>e+t.insert.length,0),u=l.indexAfterToken+c,h=t.index-c
if(h===l.indexAfterToken){if(r.insert.slice(l.indexAfterToken).match(/^[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/))return{query:r.insert[l.indexAfterToken],queryStartIndex:l.indexAfterToken,queryToken:l.token}
const e=r.insert.slice(l.indexAfterToken).match(/^\w+/)
if(!e)return{query:a,queryStartIndex:u,queryToken:l.token}}let p=r.insert.slice(l.indexAfterToken,h)
const m=r.insert.slice(h).match(/^\w+/)
m&&(p+=m[0])
if(!(function(e){return-1===e.indexOf("\n")&&e.length<=s})(p))return null
return{query:p,queryToken:l.token,queryStartIndex:u}}
e.prevBlotIsEqualMention=function(e,t){return e instanceof n.default&&e.next===t&&(0,i.isShallowEqualObjects)(t.formats().mention,e.formats().mention)}
e.didDeleteTriggerCharacter=function(e,t){if(!e||!t)return!1
return t.diff(e).ops.some(e=>e.insert&&o.some(t=>e.insert.includes(t)))}
e.MENTION_DENOTATION_CHARACTERS=e.MENTION_QUERY_LENGTH_LIMIT=e.DEFAULT_TYPEAHEAD_QUERY_NO_TEXT=void 0
const r=["member"],a="a"
e.DEFAULT_TYPEAHEAD_QUERY_NO_TEXT=a
const s=100
e.MENTION_QUERY_LENGTH_LIMIT=s
const o=["@","@","ï¼ "]
e.MENTION_DENOTATION_CHARACTERS=o})
define("participate-text-editor/utils/quill/modules/clipboard",["exports","quill"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
const i=t.default.import("modules/clipboard"),n=t.default.import("delta")
e.default=class extends i{onPaste(e){var t
if(null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text/link-preview")){const t=this.quill.getSelection()
if(!t)return super.onPaste(e)
e.preventDefault()
const i=e.clipboardData.getData("text/plain"),r=(new n).retain(t.index).delete(t.length).insert(i)
this.quill.updateContents(r,"silent")
const a=i.length+t.index,s=0
this.quill.setSelection(a,s,"silent")}return super.onPaste(e)}}})
define("participate-text-editor/utils/quill/modules/hashtag",["exports","@babel/runtime/helpers/esm/toConsumableArray","@babel/runtime/helpers/esm/objectSpread2","quill","participate-text-editor/utils/quill/blots/hashtag","participate-text-editor/utils/quill/hashtag-utils","participate-text-editor/utils/tracking/hashtag-tracking","participate-text-editor/utils/constants"],function(e,t,i,n,r,a,s,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
const l=n.default.import("core/module"),d=n.default.import("delta")
class c extends l{static register(){n.default.register("blots/hashtag",r.default)}constructor(e,t){super(e,t)
this.options=(0,i.default)({actions:{openTypeahead:null,closeTypeahead:null,generateNewWorkflowId:null,fireCustomTexteditorTrackingEvent:null,fireControlInteractionEvent:null},trackingData:{associatedInputControlUrn:null,associatedEntityUrn:null,controlType:null,rootObject:null}},t)
this.actions=this.options.actions
this.trackingData=this.options.trackingData
this.context=this.options.context
this.hasTriggeredTypeahead=!1
this.attachMatchers()
this.attachEvents()}_setTypeaheadTriggeredValue(e){this.hasTriggeredTypeahead=e}compositionEnd(){const e=this.quill.getContents()
this.createFormattedHashtags(e)
const t=this.quill.getSelection()
t&&this.detectTypeaheadTrigger(t.index)}attachMatchers(){var e;(e=this.quill.clipboard).addMatcher.apply(e,(0,t.default)(c.matchHashtag()))}attachEvents(){this.quill.on("hashtag-unwrap",this.unwrapHashtag.bind(this))
this.quill.on("editor-change",this.onEditorChange.bind(this))
this.quill.root.addEventListener("compositionend",this.compositionEnd.bind(this))}static matchHashtag(){return[r.default.className,(e,t)=>{const[i]=t.ops
return(new d).insert(i.insert)}]}unwrapHashtag(e){const t=this.quill.getIndex(e),i=e.length()
this.quill.removeFormat(t,i)}onEditorChange(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r]
const a=i[2]
if(!this.quill.selection.composing)if(e===n.default.events.TEXT_CHANGE&&a===n.default.sources.USER){const e=this.quill.getContents(),t=i[0].ops.some(e=>e.insert&&e.insert.includes("\n"))
this.createFormattedHashtags(e,t)
const n=this.quill.getSelection()
if(!n)return
this.detectTypeaheadTrigger(n.index)}else if(e===n.default.events.SELECTION_CHANGE){const[e,t]=i
!e||t&&e.index===t.index||this.detectTypeaheadTrigger(e.index)}}insertHashtag(e,t,i){const r=e.text.length+t,a=(new d).retain(t).delete(i).insert(e.text,{hashtag:!0}).insert(" ")
this.quill.updateContents(a,n.default.sources.USER)
this.quill.setSelection(r+" ".length,n.default.sources.USER)}onTypeaheadSelect(e,t){const i=this.quill.getSelection(!0).index,[n]=this.quill.getLeaf(i),r=n.text.slice(1),a=(0,s.getSearchHeaderForHashtagTrackingEvent)(r)
if(!n)return
const l=this.quill.getIndex(n),d={text:e.text}
this.insertHashtag(d,l,n.text.length)
this.actions.fireControlInteractionEvent(`${this.trackingData.controlType}_select_hashtag_typeahead`)
this.actions.fireCustomTexteditorTrackingEvent(s.EVENTS.ACTION,(0,s.getHashtagSuggestionActionSelectEventPayload)(a,e,t),o.TYPEAHEAD_TYPES_MAP.HASHTAG)
this._setTypeaheadTriggeredValue(!1)}createFormattedHashtags(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]
const i=e.diff((0,a.transformDelta)(e.ops))
i.ops.length>0?this.quill.updateContents(i):t&&this.quill.setContents(e)}fireDismissTypeaheadTracking(e){if(e){const t=(0,s.getSearchHeaderForHashtagTrackingEvent)(e)
this.actions.fireCustomTexteditorTrackingEvent(s.EVENTS.ACTION,(0,s.getHashtagSuggestionActionDismissEventPayload)(t),o.TYPEAHEAD_TYPES_MAP.HASHTAG)}}detectTypeaheadTrigger(e){const[t]=this.quill.getLeaf(e)
if(t&&t.parent instanceof r.default){const e=t.text.substring(1)
this.query=e
this.actions.openTypeahead({typeaheadQuery:e,typeaheadType:r.default.blotName,onTypeaheadSelect:this.onTypeaheadSelect.bind(this),onDismissWithoutSelection:this.fireDismissTypeaheadTracking.bind(this)})
if(!this.hasTriggeredTypeahead){this.actions.generateNewWorkflowId()
const t=(0,s.getSearchHeaderForHashtagTrackingEvent)(e)
this.actions.fireCustomTexteditorTrackingEvent(s.EVENTS.START,(0,s.getHashtagSuggestionStartEvent)(t,this.trackingData.associatedInputControlUrn),o.TYPEAHEAD_TYPES_MAP.HASHTAG)}this._setTypeaheadTriggeredValue(!0)}else{this._setTypeaheadTriggeredValue(!1)
this.actions.closeTypeahead(r.default.blotName)}}}e.default=c})
define("participate-text-editor/utils/quill/modules/mention",["exports","@babel/runtime/helpers/esm/objectSpread2","@babel/runtime/helpers/esm/toConsumableArray","quill","participate-text-editor/utils/quill/blots/mention","participate-text-editor/utils/quill/formats/guard","participate-text-editor/utils/quill/mention-utils","participate-text-editor/utils/quill/utils","participate-text-editor/utils/tracking/mentions-tracking","participate-text-editor/utils/constants","global-utils/utils/is-browser"],function(e,t,i,n,r,a,s,o,l,d,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
const u=n.default.import("core/module"),h=n.default.import("delta"),p=n.default.import("parchment"),m=n.default.import("blots/text"),g=3
e.default=class extends u{static register(){n.default.register("blots/mention",r.default)
n.default.register("formats/guard",a.default)}constructor(e,t){super(e,t)
this.range=e.getSelection()
this.options={actions:{openTypeahead:null,closeTypeahead:null,generateNewWorkflowId:null,fireCustomTexteditorTrackingEvent:null,fireControlInteractionEvent:null},trackingData:{associatedInputControlUrn:null,associatedEntityUrn:null,controlType:null,rootObject:null,updateMetadata:null}}
Object.assign(this.options,t)
this.actions=this.options.actions
this.trackingData=this.options.trackingData
this.attachEvents()
this.attachMatchers()
this.hasTriggeredTypeahead=!1}attachMatchers(){var e,t;(e=this.quill.clipboard).addMatcher.apply(e,(0,i.default)(this.matchMention()));(t=this.quill.clipboard).addMatcher.apply(t,(0,i.default)(this.matchTextNode()))}attachEvents(){this.quill.on("mention-will-reload",this.onMentionWillReload.bind(this))
this.quill.on("mention-move-text-before",this.onMentionMoveTextBefore.bind(this))
this.quill.on("mention-move-text-after",this.onMentionMoveTextAfter.bind(this))
this.quill.on("mention-range-will-change",this.onMentionWillChange.bind(this))
this.quill.on("mention-will-unwrap",this.onMentionWillUnwrap.bind(this))
this.quill.on("mention-will-remove",this.onMentionWillRemove.bind(this))
this.quill.on(n.default.events.TEXT_CHANGE,this.onTextChange.bind(this))
this.quill.on(n.default.events.EDITOR_CHANGE,(e,t)=>{e===n.default.events.SELECTION_CHANGE&&this.onSelectionChange(t)})
this.quill.root.addEventListener("compositionstart",this.compositionStart.bind(this))
this.quill.root.addEventListener("compositionend",this.compositionEnd.bind(this))}_setTypeaheadTriggeredValue(e){this.hasTriggeredTypeahead=e}_removeGuards(){const e=this.quill.scroll.descendants(a.default,0,this.quill.getLength()),t=e.length
e.forEach((e,i)=>{const n=this.quill.getIndex(e)
e.domNode.parentNode.removeChild(e.domNode)
t===i+1&&this._queueSetSelection(n)})}_queueSetSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0
const{quill:i}=this
c.default&&window.requestAnimationFrame(()=>{i.setSelection(e,t,n.default.sources.USER)})}matchTextNode(){return[g,(e,t)=>{const i=this.range.index,[n]=this.quill.getLeaf(i),r=n.parent
this.isIndexInsideMention(i,r)&&this.quill.removeFormat(this.quill.getIndex(r),r.length())
return t}]}matchMention(){return[".ql-mention",(e,t)=>{const i=t.ops[0],n=r.default.formats(e)
n.guid=r.default.createGuid()
i.attributes={mention:n}
i.attributes.mention.originalText=i.insert
const s=new h([{insert:a.default.CONTENT,attributes:{guard:!0}}])
return(new h).concat(s).concat(t).concat(s)}]}isIndexInsideMention(e,t){if(t instanceof r.default){const{start:i,end:n}=(0,o.getBlotIndices)(this.quill,t)
return e>i&&e<n}return!1}onMentionMoveTextAfter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:""
if(!(e.next instanceof m)){const t=p.create("text","")
null==e.next?t.insertInto(e.parent):e.parent.insertBefore(t,e.next)}e.deleteAt(e.length()-t.length,t.length,!0)
e.next.insertAt(0,t)
this.onMentionWillChange(e,e.length()+1)}onMentionWillReload(){const e=this.quill.getSelection()
this.quill.setContents(this.quill.getContents())
e&&this.quill.setSelection(e.index)}onMentionMoveTextBefore(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:""
if(!(e.prev instanceof m)){const t=p.create("text","")
e.parent.insertBefore(t,e)}e.deleteAt(0,t.length,!0)
e.prev.insertAt(e.prev.length(),t)
this.onMentionWillChange(e,0)}onTextChange(e,t){if(this.quill.selection.composing)return
const i=this.quill.getSelection()
null!==i&&(this.range=i)
if(e&&e.ops){const i=e.ops.some(e=>e.attributes&&e.attributes.mention),n=this.quill.getContents()
i?this._removeGuards():(0,s.didDeleteTriggerCharacter)(t,n)&&this._setTypeaheadTriggeredValue(!1)}this.willDetectTypeaheadTrigger()}onSelectionChange(e){null!==e&&(this.range=e)
this.willDetectTypeaheadTrigger()}onMentionWillChange(e,t){const i=this.quill.getIndex(e)+t,n=(0,l.getSearchHeaderForMentionsTrackingEvent)()
this.actions.fireCustomTexteditorTrackingEvent(l.EVENTS.MENTION_ACTION,(0,l.getMentionSuggestionActionEventPayload)(n,l.ACTIONS.PERSONALIZE),d.TYPEAHEAD_TYPES_MAP.MENTION)
this._queueSetSelection(i)}onMentionWillRemove(e){const t=this.quill.getIndex(e)
e.remove()
const i=(0,l.getSearchHeaderForMentionsTrackingEvent)()
this.actions.fireCustomTexteditorTrackingEvent(l.EVENTS.MENTION_ACTION,(0,l.getMentionSuggestionActionEventPayload)(i,l.ACTIONS.DELETE),d.TYPEAHEAD_TYPES_MAP.MENTION)
this.currentMentionToken=null
this._queueSetSelection(t)}onMentionWillUnwrap(e){const t=this.range.index
this.quill.removeFormat(this.quill.getIndex(e),e.length())
const i=(0,l.getSearchHeaderForMentionsTrackingEvent)()
this.actions.fireCustomTexteditorTrackingEvent(l.EVENTS.MENTION_ACTION,(0,l.getMentionSuggestionActionEventPayload)(i,l.ACTIONS.DELETE),d.TYPEAHEAD_TYPES_MAP.MENTION)
this.quill.setSelection(t,0,n.default.sources.USER)}compositionStart(){this.actions.closeTypeahead(d.TYPEAHEAD_TYPES_MAP.MENTION)}compositionEnd(){const e=this.quill.getSelection()
if(e){this.range=e
this.willDetectTypeaheadTrigger()}}willDetectTypeaheadTrigger(){if(null==this.range)return
const e=(0,s.getSearchQuery)(this.quill.getContents(),this.range)
if(e){this.actions.openTypeahead({typeaheadQuery:e.query,typeaheadType:d.TYPEAHEAD_TYPES_MAP.MENTION,onTypeaheadSelect:this.insertMention.bind(this,e.queryStartIndex,e.queryToken,e.query.length),onDismissWithoutSelection:this.fireDismissTypeaheadTracking.bind(this)})
if(!this.hasTriggeredTypeahead){this.actions.generateNewWorkflowId()
this.actions.fireControlInteractionEvent(`${this.trackingData.controlType}_mention_start`)
const t=(0,l.getSearchHeaderForMentionsTrackingEvent)(e.query)
this.actions.fireCustomTexteditorTrackingEvent(l.EVENTS.START,(0,l.getMentionSuggestionStartEventPayload)(t,this.trackingData.associatedInputControlUrn,this.trackingData.associatedEntityUrn,this.trackingData.rootObject,this.trackingData.updateMetadata,e.queryToken),d.TYPEAHEAD_TYPES_MAP.MENTION)}this._setTypeaheadTriggeredValue(!0)}else this.actions.closeTypeahead(d.TYPEAHEAD_TYPES_MAP.MENTION)}fireDismissTypeaheadTracking(e){if(e){const t=(0,l.getSearchHeaderForMentionsTrackingEvent)(e)
this.actions.fireCustomTexteditorTrackingEvent(l.EVENTS.MENTION_ACTION,(0,l.getMentionSuggestionActionEventPayload)(t,l.ACTIONS.DISMISS),d.TYPEAHEAD_TYPES_MAP.MENTION)}}insertMention(e,i,r,o,c){const u=e-i.length,p=i.length,m=(0,t.default)((0,t.default)({},o),{},{originalText:o.text}),g=this.quill.getText(e,r).trim()||s.DEFAULT_TYPEAHEAD_QUERY_NO_TEXT
let f=0
const T=this.quill.getText(e,m.originalText.length).toLowerCase()
f=r>=m.originalText.length?p+r:T===m.originalText.toLowerCase()?p+m.originalText.length:p+r
delete m.text
const E=(new h).retain(u).delete(f).insert(a.default.CONTENT,{guard:!0}).insert(m.originalText,{mention:m}).insert(a.default.CONTENT,{guard:!0})
this.quill.updateContents(E,n.default.sources.USER)
const x=u+m.originalText.length
this._queueSetSelection(x)
const b=(0,l.getSearchHeaderForMentionsTrackingEvent)(g)
this.actions.fireControlInteractionEvent(`${this.trackingData.controlType}_mention_select`)
this.actions.fireCustomTexteditorTrackingEvent(l.EVENTS.MENTION_ACTION,(0,l.getMentionSuggestionActionSelectEventPayload)(b,m,c),d.TYPEAHEAD_TYPES_MAP.MENTION)
this._setTypeaheadTriggeredValue(!1)
this.actions.closeTypeahead(d.TYPEAHEAD_TYPES_MAP.MENTION)}}})
define("participate-text-editor/utils/quill/quill-keyboard-bindings",["exports","quill"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.enterKeyBinding=void 0
const i={"entity enter":{key:t.default.import("modules/keyboard").keys.ENTER,format:["mention"],handler:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const n=e.index
if(n&&""!==i.prefix&&""!==i.suffix){const[e]=this.quill.getLeaf(n)
this.quill.removeFormat(this.quill.getIndex(e),e.length(),t.default.sources.SILENT)
this.quill.setSelection(n)}return!0}}}
e.enterKeyBinding=i})
define("participate-text-editor/utils/quill/utils",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.normalizeTypeaheadResponse=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return{entityUrn:Ember.getWithDefault(e,"targetUrn",""),objectUrn:Ember.getWithDefault(e,"objectUrn",""),text:Ember.getWithDefault(e,"text.text",""),trackingId:Ember.getWithDefault(e,"trackingId","")}}
e.getBlotIndices=function(e,t){if(e&&t){const i={}
i.start=e.getIndex(t)
i.end=i.start+t.length()
return i}return}
e.trimLineBreakFromDelta=function(e){const t=e.ops[e.ops.length-1]
t.insert&&t.insert.endsWith("\n")&&(t.insert=t.insert.slice(0,-1))}
e.isShallowEqualObjects=function(e,t){if(e===t)return!0
if("object"!=typeof e||null==e)return!1
if("object"!=typeof t||null==t)return!1
const i=Object.keys(e)
if(i.length!==Object.keys(t).length)return!1
return i.every(i=>e[i]===t[i])}
e.isAlphaNumericCharacter=function(e){if(e)return!!e.match(t)
return!1}
const t=new RegExp(/\w/)})
define.alias("client-sensor-web/utils/run-loop-helpers","participate-text-editor/utils/run-loop-helpers")
define.alias("@linkedin/ember-restli-api-metadata/utils/schema-helpers","participate-text-editor/utils/schema-helpers")
define("participate-text-editor/utils/text-editor-utils",["exports","participate-text-editor/utils/constants","participate-text-editor/utils/quill/mention-utils"],function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.isValidTypeaheadType=function(e){return Object.values(t.TYPEAHEAD_TYPES_MAP).includes(e)}
e.mentionQueryMatchesRecommendedMention=function(e,t){if(t===i.DEFAULT_TYPEAHEAD_QUERY_NO_TEXT)return!0
const n=t.toLowerCase()
return e.toLowerCase().startsWith(n)}})
define("participate-text-editor/utils/tracking/hashtag-tracking",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.getSearchHeaderForHashtagTrackingEvent=function(){return{query:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",platform:"TYPEAHEAD"}}
e.getHashtagSuggestionStartEvent=function(e,t,i,n){return{searchHeader:e,associatedInputControlUrn:`${t}_add_commentary`,associatedEntityUrn:i,rootObject:n,hashtagSourceType:"TYPEAHEAD"}}
e.getHashtagSuggestionActionDismissEventPayload=function(e){return{searchHeader:e,actionType:t.DISMISS,hashtagSourceType:"TYPEAHEAD"}}
e.getHashtagSuggestionActionSelectEventPayload=function(e,i,n){return{searchHeader:e,actionType:t.SELECT,result:{entityUrn:i.objectUrn,position:{index:n},trackingId:i.trackingId},hashtagSourceType:"TYPEAHEAD"}}
e.ACTIONS=e.EVENTS=void 0
e.EVENTS={START:"HashtagSuggestionStartEvent",ACTION:"HashtagSuggestionActionEvent"}
const t={SELECT:"SELECT",DISMISS:"DISMISS"}
e.ACTIONS=t})
define("participate-text-editor/utils/tracking/mentions-tracking",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.getMentionSuggestionStartEventPayload=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5?arguments[5]:void 0
const s=r?{objectUrn:Ember.get(r,"shareUrn"),trackingId:Ember.get(r,"trackingData.trackingId")}:n
return{searchHeader:e,associatedInputControlUrn:`${t}_mention_start`,associatedEntityUrn:i,rootObject:s,mentionType:"EXPLICIT",mentionStartOperator:a}}
e.getSearchHeaderForMentionsTrackingEvent=function(){return{query:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",platform:"TYPEAHEAD",vertical:"PEOPLE"}}
e.getMentionSuggestionActionSelectEventPayload=function(e,i,n){return{searchHeader:e,actionType:t.SELECT,result:{entityUrn:i.objectUrn,position:{index:n}}}}
e.getMentionSuggestionActionEventPayload=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null
return{searchHeader:e,actionType:t,result:i}}
e.ACTIONS=e.EVENTS=void 0
e.EVENTS={START:"MentionSuggestionStartEvent",VIEW_LIST:"MentionSuggestionImpressionEvent",MENTION_ACTION:"MentionSuggestionActionEvent",RESULT_IMPRESSION:"MentionResultHit"}
const t={SELECT:"SELECT",DELETE:"DELETE",DISMISS:"DISMISS",PERSONALIZE:"PERSONALIZE"}
e.ACTIONS=t})
define("participate-text-editor/utils/tracking/texteditor-tracking",["exports","participate-text-editor/utils/constants","ember-cli-pemberly-tracking/utils/uuid"],function(e,t,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0})
e.default=void 0
e.default=class{constructor(e,t){this.trackingService=e
this.workflowId=t
this.typeaheadSearchId=i.default.v4()}fireTrackingEvent(e,i,n){i.searchHeader&&(i.searchHeader.rawSearchId=this.typeaheadSearchId)
switch(n){case t.TYPEAHEAD_TYPES_MAP.MENTION:i.mentionWorkflowId=this.workflowId
this.trackingService.fireTrackingPayload(e,i)
break
case t.TYPEAHEAD_TYPES_MAP.HASHTAG:i.hashtagWorkflowId=this.workflowId
this.trackingService.fireTrackingPayload(e,i)}}}})
define.alias("ember-vector-images/utils/vector-url","participate-text-editor/utils/vector-url")

//# sourceMappingURL=engine.map